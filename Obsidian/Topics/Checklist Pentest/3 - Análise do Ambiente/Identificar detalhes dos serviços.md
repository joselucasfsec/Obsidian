**1-Identificar detalhes do serviço em execução
2-Estudar o serviço/protocolo para entender o funcionamento
3-Tentar interagir com o serviço/protocolo afim obter mais informações do host
4-Indetificar possíveis vulnerabilidades/ vetores de ataque

HTTP
Buscar versões do Web Server(IIS, Apache, etc), Tecnologias utilizadas(php, asp, jsp etc) e métodos aceitos(PUT, POST, DELETE, etc)
**Versões do protocolo: HTTP/1.0 | HTTP/1.1(usar o Host: )
Requisições: GET | HEAD | OPTIONS
Utilitários: nc | curl | telnet**

Requisições
	nc - v url 80
	GET / HTTP/1.1
	Host: businesscorp.com.br
	Informar o host para obter resposta
Se soubermos a tecnologia do alvo podemos requisitar um arquivo naquela tecnologia para obter sua versão:
	GET /index.aspx HTTP/1.0

HTTPs
Funciona nas portas 443 e 8443 Devemos utilizar o openssl para fazer nossas requisições
	openssl s_client  -connect www.tesla.com:443.
	-quiet = omitir algumas infos
	usar o http/1.1 com Host:

FTP
Se nos conectarmos no alvo podemos verificar seu banner e sua versão:
	nc -vn 172.16.1.245 21
Para interagir com o protocolo:
	USER usuario
	PASS senha
	QUIT
Utilitário do ftp:
	ftp 172.16.1.5
Validar os usuarios default anonymous e ftp eles possuem acesso ao protocolo mias sem privilégios. Usar o modo 'passive, pass, pasv' para navegar no alvo.

Código para interagir com o ftp
	#!/usr/bin/python
	import socket
-
	tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	tcp.connect(("172.16.1.108",21))
-
	print ("Conectando ao servidor...")
	banner = tcp.recv(1024)
	print (banner)
-
	print ("Enviando usuario...")
	tcp.send("USER ftp\r\n")
	user = tcp.recv(1024)
	print (user)

NetBios/SMB
Utilizado para compartilhamento de arquivos e diretórios.
NetBIOS - 139(TCP) 'hosts mais antigos'
SMB - 445(TCP) 'sistemas mais modernos'
Null Session se autenticar no host com usuários e senha (nulos)
IPC$() compartilhamento oculto em windows e samba

**Enumerando através do windows**
Podemos user o nbtstat ele mostra estatísticas do protocolo usando netbios
	-R limpar cache
	-c maquinas que já comunicou
	-a nome da maquina
	-A endereço ip
Usar o net-view para verificar informações de determinadas maquinas
	net use \\172.16.1.5
	"" /u:"" null session
	net use H: \\172.16.1.5\opt monta o diretorio na nossa maquina
	net use h: /delete
	net use \\172.16.1.5 /delete 
Scripts do nmap para testar o smb
	ls usr/share/nmap/scripts/smb
	nmap --script=smb-vuln-ms* testar todos os ms

**Enumerando através do Linux**
Podemos usar o nbtsan para varrer a rede e trazer hosts com smb ativoPara se conectar a maquina usamos o smbclient
	-L = listar os diretórios compartilhados
	-N = não perguntar a senha
	-U = usuário
	\\$IP = listar os diretórios
	//$ip/directory = se conectar ao diretório 
	get text.txt = baixar arquivo da maquina
Alguns alvos vão precisar da primeira versão do protocolo
	--option='client in protocol=NT1'
Automatizando a enumeração NetBios/SMB
Utilizamos o enum4linux
	enum4linux -U 172.16.1.5
	-S compartilhamentos
	-a todas as informações possíveis
Enumeração com o nmap
	ls /usr/share/nmap/scripts/smb
	nmap --script=script

RPC
Enumeração com RPCCLIENT utilizado para se conectar ao alvo e conseguir informações.
	rpcclient -U "" -N 172.16.1.5

POP3
Serviço de caixa de entrada de e-mail, roda na porta 110 podemos nos conectar usando nc e telnet para coletar informações.
	USER usuário
	PASS senha
	STAT  mostrar status
	LIST listar as mensagens
	RETR 1 ler a mensagem 1

SMTP
Protocolo de Transferência de Correio Simples porta 25. Podemos nos conectar e aguardar uma resposta com o banner. Utilizando esse protocolo podemos fazer uma enumeração de usuários no sistema:
	HELO usuário
	EHLO usuário comandos permitidos
	HELP 
	VRFY usuário enumerar usuários
Interagir com o servidor para mandar um e-mail também é possível enumerar os usuários 
	mail from: pentest
	rcpt to: usuário

Telnet 
Uma interface administrativa via linha de comando na porta 23 utilizado em equipamentos de redes routers / switch / firewall. Essas interfaces solicitam credenciais que podem ser default, podemos identificar o dispositivo de rede e encontrar as credenciais no site do fabricante.
	telnet 172.16.1.5
Ele retorna com o banner e versões ou dispositivos.

SSH
Roda nas portas 22,2222 iniciar fazendo um banner gathering, depois enumerar os métodos de  autenticação. 
Configurações do ssh em etc/ssh/sshd_config
O root por padrão não consegue se autenticar podemos mudar isso no sshd
Método de publickey
	Na diretório do root é possível configurar as chaves permitidas:
		.ssh/authorized_keys
Criar um chave publica
	ssh-keygen criar chave
Os arquivos idid_rsa é a chave privada e o idid_rsa.pub é a publica. Adicionando a chave publica no authorized_keys podemos nos autenticar no ssh.
	ssh-add idid_rsa utilizar essa chave para se autenticar.
**Em um pentest com acesso limitado podemos criar o diretório .ssh no nosso usuário e registrar nossa chave publica no authorized_keys**

NFS 
Protocolo para compartilhamento de sistemas em redes linux funciona na porta 2049.
	rpcinfo -p 172.16.1.5 | grep nfs versões suportadas
	showmount -e 172.16.1.5 compartilhamentos
Criar um diretório na nossa maquina e rodar um mount
	mount -t nfs -o nfsvers=2 172.16.1.5:/ /tmp/nfs
Agora enumerar o diretório compartilhado

SNMP
Protocolo para gerenciamento de dispositivos de redes, roda na porta 161(UDP).
Nos conectando conseguimos usuários, programas, portas, sistema.
OID - Object Identifier | código para idenficar os objetos