Primeiro precisamos enumerar quais bibliotecas o script python está importando. Sabendo qual a biblioteca e versão de python utilizada vamos buscar se temos permissão de escrita na biblioteca.
	**/usr/lib64/python**

Na ultima linha do binário da biblioteca vamos adicionar nossa payload com o endereço da nossa reverse shell.

## **Python Library Hijacking Python PATH**

Essa vulnerabilidade é baseada na biblioteca Python que está pesquisando na variável de ambiente Python PATH. Esta variável contém uma lista de diretórios onde o python procura os diferentes diretórios para os módulos importados.
1. Vamos decobrir a biblioteca que o script python está importando.
2. Criar um binario falso da biblioteca e adicionar uma chamada de shell dentro dele.
```
import os
is.system("/bin/bash")
```
3. Executar o script original da seguinte forma:

```
sudo -u leia PYTHONPATH=/tmp/ /usr/bin/python3.7 /opt/script.py
```


